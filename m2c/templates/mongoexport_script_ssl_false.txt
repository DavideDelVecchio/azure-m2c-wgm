#!/bin/bash

# Bash shell script to export each source collection via mongoexport.
#
# Database Name: {{ dbname }}
# Generated on:  {{ gen_timestamp }}

source env.sh

mkdir -p data/source/mongoexports

{% for c in collections %}
mongoexport \
  --host $M2C_SOURCE_MONGODB_HOST \
  --port $M2C_SOURCE_MONGODB_PORT \
  --db {{ dbname }} \
  --username $M2C_SOURCE_MONGODB_USER \
  --password $M2C_SOURCE_MONGODB_PASS \
  --collection {{ c['name'] }} \
  --out {{ outdir }}/{{ dbname }}__{{ c['name'] }}__source.json
{% endfor %}

echo 'done'
